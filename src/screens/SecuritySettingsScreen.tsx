import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { Modal, useModal } from '../components';
import './screens.css';

interface ActiveSession {
  id: string;
  device: string;
  location: string;
  time: string;
  isCurrent: boolean;
}

/**
 * SecuritySettingsScreen Component
 * Manage security settings and active sessions
 */
const SecuritySettingsScreen: React.FC = () => {
  const navigate = useNavigate();
  const [biometricsEnabled, setBiometricsEnabled] = useState(true);
  const { modalState, showModal, hideModal } = useModal();

  const activeSessions: ActiveSession[] = [
    { id: '1', device: 'iPhone 14 Pro (This device)', location: 'Singapore', time: 'Just now', isCurrent: true },
    { id: '2', device: 'Chrome on MacOS', location: 'Singapore', time: '2 hrs ago', isCurrent: false }
  ];

  const handleBack = () => {
    navigate(-1);
  };

  const handleChangePIN = () => {
    showModal({
      title: 'Change PIN',
      message: 'Change PIN functionality',
      type: 'info',
    });
  };

  const handleChangePassword = () => {
    showModal({
      title: 'Change Password',
      message: 'Change Password functionality',
      type: 'info',
    });
  };

  const handleLogOutOtherDevices = () => {
    showModal({
      title: 'Log Out Other Devices',
      message: 'Are you sure you want to log out all other devices?',
      type: 'warning',
      showCancel: true,
      onConfirm: () => {
        showModal({
          title: 'Success',
          message: 'Logged out from all other devices',
          type: 'success',
        });
      },
    });
  };

  return (
    <div className="security-settings-screen">
      <div className="security-settings-container">
        {/* Header */}
        <div className="security-header">
          <button className="back-btn" onClick={handleBack}>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M11.369 4.22462C11.7618 3.90427 12.3408 3.92686 12.7069 4.29298C13.073 4.65909 13.0956 5.2381 12.7753 5.63087L12.7069 5.70704L6.41399 12L12.7069 18.293L12.7753 18.3692C13.0956 18.7619 13.073 19.3409 12.7069 19.707C12.3408 20.0732 11.7618 20.0958 11.369 19.7754L11.2929 19.707L4.29289 12.707C3.90237 12.3165 3.90237 11.6835 4.29289 11.293L11.2929 4.29298L11.369 4.22462Z" fill="#565E6D" />
              <path d="M19 11C19.5523 11 20 11.4477 20 12C20 12.5523 19.5523 13 19 13L5 13C4.44772 13 4 12.5523 4 12C4 11.4477 4.44772 11 5 11L19 11Z" fill="#565E6D" />
            </svg>
          </button>
          <h1 className="security-title">Security Settings</h1>
          <div style={{ width: '40px' }}></div>
        </div>

        <div className='security-content'>
          {/* Security Status */}
          <div className="security-status-card">
            <div className="security-icon">
              <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M25.31 8.01963C22.2251 8.01963 18.6209 6.24196 16.1469 4.08288C16.1059 4.0479 16.0539 4.02963 16 4.02963C15.9462 4.02963 15.8942 4.04921 15.8532 4.08419L15.852 4.08288C13.4692 6.16032 10.0008 7.90726 6.98097 8.01443L6.69003 8.01963L6.69003 17.3297L6.70172 17.8778C6.82013 20.5716 7.81587 22.5683 9.33185 24.1212C10.7785 25.6028 12.7456 26.7255 15.0077 27.6021L15.9948 27.9632L16.0248 27.9722C18.6914 27.0416 21.0179 25.817 22.6683 24.1237C24.2846 22.4654 25.31 20.3033 25.31 17.3297L25.31 8.01963ZM27.97 17.3297C27.97 21.0059 26.668 23.8323 24.5736 25.9811C22.5154 28.0927 19.7512 29.492 16.8897 30.4894L16.8793 30.4932C16.3099 30.6862 15.6925 30.6793 15.1273 30.4763C15.1194 30.4737 15.1117 30.4713 15.1039 30.4686C15.1017 30.4678 15.0994 30.4681 15.0974 30.4673V30.466C12.2388 29.4758 9.48244 28.0829 7.42906 25.9799C5.46353 23.9667 4.19651 21.3573 4.04562 18.0103L4.03003 17.3297L4.03003 8.01963C4.03019 7.31437 4.31062 6.63763 4.80933 6.13893C5.30815 5.64027 5.98469 5.35963 6.69003 5.35963L7.11735 5.34404C9.29479 5.18375 12.0812 3.84685 14.1141 2.07099L14.1258 2.06191L14.3272 1.90345C14.8139 1.55723 15.3985 1.36963 16 1.36963C16.6016 1.36963 17.1861 1.55723 17.6729 1.90345L17.8743 2.06191L17.886 2.07099L18.3041 2.42298C20.44 4.14567 23.2189 5.35963 25.31 5.35963C26.0153 5.35963 26.6919 5.64027 27.1908 6.13893C27.6894 6.63764 27.9699 7.31437 27.97 8.01963L27.97 17.3297Z" fill="#171A1F" />
              </svg>
            </div>
            <div className="security-status-info">
              <h3 className="security-status-title">Security is Strong</h3>
              <p className="security-status-desc">2FA Enabled • Biometrics Active</p>
            </div>
          </div>

          {/* Authentication */}
          <div className="security-section">
            <h3 className="security-section-title">AUTHENTICATION</h3>

            <div className="security-item">
              <div className="security-item-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8.99966 12C8.99966 11.2044 9.31603 10.4415 9.87857 9.87891C10.4411 9.31635 11.2041 9.00006 11.9997 9C12.5519 9 12.9997 9.44772 12.9997 10C12.9997 10.5523 12.5519 11 11.9997 11C11.7345 11.0001 11.4801 11.1055 11.2926 11.293C11.1052 11.4805 10.9997 11.7348 10.9997 12C10.9997 13.0698 10.8959 14.5988 10.734 16.1064C10.6751 16.6555 10.1824 17.0529 9.63345 16.9941C9.08443 16.9352 8.68697 16.4426 8.74576 15.8936C8.90385 14.4213 8.99966 12.9701 8.99966 12Z" fill="#171A1F" />
                  <path d="M13.0001 13.1201C13.0001 12.5678 13.4478 12.1201 14.0001 12.1201C14.5524 12.1201 15.0001 12.5678 15.0001 13.1201C15.0001 14.3066 15.0006 15.9387 14.8722 17.5928C14.745 19.2307 14.4861 20.9776 13.9288 22.3711C13.7237 22.8838 13.1417 23.1336 12.629 22.9287C12.1163 22.7236 11.8665 22.1416 12.0714 21.6289C12.5139 20.5226 12.7552 19.0193 12.878 17.4375C12.9996 15.8716 13.0001 14.3136 13.0001 13.1201Z" fill="#171A1F" />
                  <path d="M18.2706 21.2162C18.1623 21.7578 17.6354 22.1097 17.0938 22.0014C16.5524 21.893 16.2015 21.366 16.3096 20.8246L18.2706 21.2162ZM17.8868 17.0053C18.402 17.0554 18.7878 17.4879 18.7901 17.9945L18.7852 18.0971C18.7097 18.8737 18.3899 20.6197 18.2706 21.2162L16.3096 20.8246C16.4304 20.2209 16.7305 18.567 16.795 17.9037L16.8096 17.8022C16.9095 17.3053 17.3715 16.9552 17.8868 17.0053Z" fill="#171A1F" />
                  <path d="M1 12.0002C1 9.69157 1.72634 7.44144 3.07617 5.56856C4.4261 3.69564 6.33125 2.29473 8.52148 1.56465C10.7117 0.834575 13.0766 0.811817 15.2803 1.5002C17.3462 2.14561 19.1726 3.38548 20.5342 5.05977L20.7998 5.40059L20.8574 5.48555C21.1187 5.91963 21.0137 6.48945 20.5996 6.8C20.1854 7.11051 19.6091 7.05147 19.2656 6.67891L19.2002 6.59981L18.9824 6.32149C17.8684 4.95163 16.3739 3.93741 14.6836 3.40938C12.8807 2.84619 10.9462 2.86487 9.1543 3.46211C7.36244 4.0594 5.80369 5.20531 4.69922 6.7375C3.59473 8.26989 3 10.1113 3 12.0002C3 12.5525 2.55228 13.0002 2 13.0002C1.44772 13.0002 1 12.5525 1 12.0002Z" fill="#171A1F" />
                  <path d="M2.00977 15L2.1123 15.0049C2.61655 15.0561 3.00977 15.4822 3.00977 16C3.00977 16.5178 2.61655 16.9439 2.1123 16.9951L2.00977 17H2C1.44772 17 1 16.5523 1 16C1 15.4477 1.44772 15 2 15H2.00977Z" fill="#171A1F" />
                  <path d="M21.6007 9.01964C22.1082 8.91673 22.6047 9.21814 22.7551 9.70226L22.7805 9.80089L22.8137 10.0138C22.8444 10.2515 22.8661 10.5588 22.882 10.879C22.9046 11.3326 22.9196 11.8899 22.924 12.4855C22.9327 13.6695 22.9001 15.0484 22.795 16.0997C22.74 16.6492 22.2498 17.0502 21.7003 16.9952C21.1508 16.9402 20.7498 16.45 20.8048 15.9005C20.8996 14.9521 20.9325 13.6543 20.924 12.5001C20.9198 11.9264 20.9059 11.3981 20.885 10.9786C20.8738 10.7557 20.8612 10.5799 20.8498 10.4503L20.8195 10.1993L20.8048 10.0978C20.7547 9.59346 21.0934 9.12271 21.6007 9.01964Z" fill="#171A1F" />
                  <path d="M5.43541 9.57354C5.65111 9.11497 6.18338 8.88514 6.67174 9.05694C7.16006 9.22873 7.43121 9.74112 7.31237 10.2337L7.28307 10.3323C7.09481 10.8676 6.99908 11.431 6.99987 11.9983V12.0003C6.99987 14.8879 6.55191 17.8025 6.04967 19.4944L5.94811 19.8167C5.77335 20.3405 5.20731 20.6232 4.68346 20.4485C4.1597 20.2738 3.87701 19.7077 4.05162 19.1839L4.13756 18.9085C4.56908 17.4472 4.99987 14.7372 4.99987 12.0003C4.99886 11.2061 5.13281 10.4174 5.39635 9.66827L5.43541 9.57354Z" fill="#171A1F" />
                  <path d="M8.25832 19.7269C8.39637 19.2392 8.88416 18.9259 9.39407 19.0159C9.93772 19.1121 10.3006 19.6304 10.2046 20.1741L10.148 20.4603C10.0023 21.1268 9.77161 21.7733 9.60305 22.303C9.43565 22.8292 8.87334 23.1205 8.34719 22.9534C7.82107 22.786 7.52968 22.2237 7.6968 21.6976C7.92419 20.9829 8.13009 20.4203 8.23489 19.8265L8.25832 19.7269Z" fill="#171A1F" />
                  <path d="M17 14.0005V11.9995L16.9893 11.6714C16.9395 10.9077 16.7148 10.164 16.3311 9.49854C15.8925 8.73809 15.2611 8.10666 14.501 7.66748C13.7409 7.22837 12.8788 6.99676 12.001 6.99658C11.123 6.99644 10.2603 7.22753 9.49998 7.66651C9.02169 7.94263 8.40991 7.77858 8.13377 7.3003C7.85778 6.82203 8.02175 6.21019 8.49998 5.93408C9.56437 5.31959 10.772 4.99641 12.001 4.99658C13.2301 4.99678 14.4377 5.32023 15.502 5.93506C16.5662 6.54994 17.4494 7.43482 18.0635 8.49951C18.6774 9.56411 19.0007 10.7715 19 12.0005V14.0005C19 14.5527 18.5523 15.0005 18 15.0005C17.4477 15.0005 17 14.5527 17 14.0005Z" fill="#171A1F" />
                </svg>
              </div>
              <span className="security-item-label">Face ID / Touch ID</span>
              <label className={`toggle-switch ${biometricsEnabled ? 'active' : ''}`}>
                <input
                  type="checkbox"
                  checked={biometricsEnabled}
                  onChange={() => setBiometricsEnabled(!biometricsEnabled)}
                />
                <span className="toggle-slider"></span>
              </label>
            </div>

            <button className="security-item clickable" onClick={handleChangePIN}>
              <div className="security-item-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 13C20 12.4477 19.5523 12 19 12L5 12C4.44772 12 4 12.4477 4 13L4 20C4 20.5523 4.44772 21 5 21L19 21C19.5523 21 20 20.5523 20 20L20 13ZM22 20C22 21.6569 20.6569 23 19 23L5 23C3.34315 23 2 21.6569 2 20L2 13C2 11.3431 3.34315 10 5 10L19 10C20.6569 10 22 11.3431 22 13L22 20Z" fill="#171A1F" />
                  <path d="M16 11V7C16 5.93913 15.5783 4.92202 14.8281 4.17188C14.078 3.42173 13.0609 3 12 3C10.9391 3 9.92202 3.42173 9.17188 4.17188C8.42173 4.92202 8 5.93913 8 7L8 11C8 11.5523 7.55228 12 7 12C6.44772 12 6 11.5523 6 11L6 7C6 5.4087 6.63259 3.88303 7.75781 2.75781C8.88303 1.63259 10.4087 1 12 1C13.5913 1 15.117 1.63259 16.2422 2.75781C17.3674 3.88303 18 5.4087 18 7V11C18 11.5523 17.5523 12 17 12C16.4477 12 16 11.5523 16 11Z" fill="#171A1F" />
                </svg>
              </div>
              <span className="security-item-label">Change PIN</span>
              <div className="arrow-icon">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6.92303 4.4334C7.22691 4.12952 7.70748 4.11077 8.03348 4.37666L8.09671 4.4334L13.0767 9.41342C13.4008 9.73753 13.4008 10.2629 13.0767 10.587L8.09671 15.567C7.77257 15.8912 7.24717 15.8912 6.92303 15.567C6.5989 15.2429 6.5989 14.7175 6.92303 14.3934L11.3162 10.0002L6.92303 5.60707L6.86629 5.54385C6.6004 5.21785 6.61916 4.73727 6.92303 4.4334Z" fill="#171A1F" />
                </svg>
              </div>
            </button>

            <button className="security-item clickable" onClick={handleChangePassword}>
              <div className="security-item-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19.9999 12C19.9999 9.87827 19.1574 7.84306 17.6571 6.34277C16.1573 4.84294 14.1229 4.00052 12.0018 4C9.74454 4.00896 7.578 4.88999 5.955 6.45898L3.70696 8.70703C3.31643 9.09756 2.68342 9.09756 2.29289 8.70703C1.90237 8.31651 1.90237 7.68349 2.29289 7.29297L4.55266 5.0332L4.94621 4.66992C6.89235 2.96203 9.39517 2.00982 11.996 2H11.9999L12.496 2.0127C14.9675 2.13537 17.3131 3.17061 19.0712 4.92871C20.9465 6.80407 21.9999 9.34784 21.9999 12C21.9999 12.5523 21.5522 13 20.9999 13C20.4476 13 19.9999 12.5523 19.9999 12Z" fill="#171A1F" />
                  <path d="M2 3C2 2.44772 2.44772 2 3 2C3.55228 2 4 2.44772 4 3L4 7L8 7C8.55228 7 9 7.44772 9 8C9 8.55228 8.55228 9 8 9L3 9C2.44772 9 2 8.55228 2 8L2 3Z" fill="#171A1F" />
                  <path d="M2 12C2 11.4477 2.44772 11 3 11C3.55228 11 4 11.4477 4 12C4 14.1217 4.84248 16.1569 6.34277 17.6572C7.84237 19.1568 9.8764 19.9982 11.9971 19.999C14.2548 19.9903 16.4217 19.1102 18.0449 17.541L20.293 15.293C20.6835 14.9024 21.3165 14.9024 21.707 15.293C22.0976 15.6835 22.0976 16.3165 21.707 16.707L19.4473 18.9668L19.0537 19.3301C17.1076 21.038 14.6048 21.9902 12.0039 22H12C9.34784 22 6.80407 20.9467 4.92871 19.0713C3.05335 17.1959 2 14.6522 2 12Z" fill="#171A1F" />
                  <path d="M20 21V17H16C15.4477 17 15 16.5523 15 16C15 15.4477 15.4477 15 16 15L21 15L21.1025 15.0049C21.6067 15.0562 22 15.4823 22 16V21C22 21.5523 21.5523 22 21 22C20.4477 22 20 21.5523 20 21Z" fill="#171A1F" />
                </svg>
              </div>
              <span className="security-item-label">Change Password</span>
              <div className="arrow-icon">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6.92303 4.4334C7.22691 4.12952 7.70748 4.11077 8.03348 4.37666L8.09671 4.4334L13.0767 9.41342C13.4008 9.73753 13.4008 10.2629 13.0767 10.587L8.09671 15.567C7.77257 15.8912 7.24717 15.8912 6.92303 15.567C6.5989 15.2429 6.5989 14.7175 6.92303 14.3934L11.3162 10.0002L6.92303 5.60707L6.86629 5.54385C6.6004 5.21785 6.61916 4.73727 6.92303 4.4334Z" fill="#171A1F" />
                </svg>
              </div>
            </button>
          </div>

          {/* Active Sessions */}
          <div className="security-section">
            <h3 className="security-section-title">ACTIVE SESSIONS</h3>

            {activeSessions.map(session => (
              <div key={session.id} className="session-item">
                <div className="session-icon">{session.isCurrent ? <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M14.9801 3.36012C14.9801 2.90172 14.6085 2.53012 14.1501 2.53012L5.85011 2.53012C5.39172 2.53012 5.02011 2.90172 5.02011 3.36012L5.02011 16.6401C5.02011 17.0985 5.39172 17.4701 5.85011 17.4701L14.1501 17.4701C14.6085 17.4701 14.9801 17.0985 14.9801 16.6401L14.9801 3.36012ZM16.6401 16.6401C16.6401 18.0153 15.5253 19.1301 14.1501 19.1301L5.85011 19.1301C4.47492 19.1301 3.36011 18.0153 3.36011 16.6401L3.36011 3.36012C3.36011 1.98493 4.47492 0.870117 5.85011 0.870117L14.1501 0.870117C15.5253 0.870117 16.6401 1.98493 16.6401 3.36012L16.6401 16.6401Z" fill="#171A1F" />
                  <path d="M10.0083 14.1699L10.0934 14.174C10.5119 14.2165 10.8383 14.5701 10.8383 14.9999C10.8383 15.4297 10.5119 15.7834 10.0934 15.8259L10.0083 15.8299H10.0002C9.54176 15.8299 9.17017 15.4583 9.17017 14.9999C9.17017 14.5415 9.54176 14.1699 10.0002 14.1699H10.0083Z" fill="#171A1F" />
                </svg>
                  : <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.8099 5.85523C15.8099 5.6351 15.7224 5.42406 15.5667 5.2684C15.4304 5.13217 15.2518 5.04808 15.0618 5.02928L14.9799 5.02523L5.01989 5.02523C4.79984 5.02529 4.58866 5.11279 4.43306 5.2684C4.27747 5.42404 4.18989 5.63516 4.18989 5.85523L4.18989 12.4952L15.8099 12.4952L15.8099 5.85523ZM3.03973 15.8144L3.03891 15.8152L16.9617 15.8152L16.9609 15.8144L16.1285 14.1552L3.87216 14.1552L3.03973 15.8144ZM17.4699 13.1291L18.4433 15.0679L18.4887 15.1643C18.586 15.3925 18.6311 15.6404 18.62 15.889C18.6074 16.173 18.5219 16.4491 18.372 16.6906C18.2221 16.9322 18.0122 17.1312 17.7633 17.2686C17.5159 17.405 17.2377 17.4755 16.9552 17.4744L3.04459 17.4752C2.76229 17.4762 2.48452 17.4049 2.23728 17.2686C1.98829 17.1312 1.77854 16.9322 1.62856 16.6906C1.47862 16.449 1.39316 16.173 1.38054 15.889C1.36793 15.6049 1.42845 15.3219 1.55643 15.0679L2.52989 13.1291L2.52989 5.85523C2.52989 5.19489 2.79249 4.56168 3.25939 4.09473C3.72629 3.62781 4.35958 3.36529 5.01989 3.36523L14.9799 3.36523L15.2263 3.37739C15.7963 3.43401 16.3326 3.68615 16.7412 4.09473C17.208 4.56166 17.4699 5.19499 17.4699 5.85523L17.4699 13.1291Z" fill="#171A1F" />
                  </svg>
                }</div>
                <div className="session-info">
                  <span className="session-device">{session.device}</span>
                  <span className="session-details">{session.location} • {session.time}</span>
                </div>
              </div>
            ))}

            <button className="log-out-devices-btn" onClick={handleLogOutOtherDevices}>
              Log Out Other Devices
            </button>
          </div>
        </div>
      </div>

      <Modal
        isOpen={modalState.isOpen}
        onClose={hideModal}
        title={modalState.title}
        message={modalState.message}
        type={modalState.type}
        showCancel={modalState.showCancel}
        onConfirm={modalState.onConfirm}
      />
    </div>
  );
};

export default SecuritySettingsScreen;
