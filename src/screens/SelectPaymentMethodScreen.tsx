import React, { useState } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import { ScreenType } from '../types';
import './screens.css';

/**
 * SelectPaymentMethodScreen Component
 * Select payment method with amount summary
 */
const SelectPaymentMethodScreen: React.FC = () => {
  const navigate = useNavigate();
  const location = useLocation();
  const { recipient, amount, purpose, reference } = location.state || {};
  const [selectedMethod, setSelectedMethod] = useState('wallet');

  const fee = 2.50;
  const total = parseFloat(amount || '0') + fee;

  const handleContinue = () => {
    navigate(`/${ScreenType.REVIEW_PAYMENT}`, {
      state: { recipient, amount, purpose, reference, paymentMethod: selectedMethod, fee, total }
    });
  };

  const handleBack = () => {
    navigate(-1);
  };

  return (
    <div className="select-payment-method-screen">
      <div className="select-payment-method-container">
        {/* Header */}
        <div className="payment-method-header">
          <button className="back-btn" onClick={handleBack}>←</button>
          <h1 className="payment-method-title">Select Payment Method</h1>
        </div>

        {/* Payment Methods */}
        <div className="payment-methods-list">
          <button
            className={`payment-method-card ${selectedMethod === 'wallet' ? 'selected' : ''}`}
            onClick={() => setSelectedMethod('wallet')}
          >
            <div className="method-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 13C17.7348 13 17.4805 13.1054 17.293 13.293C17.1054 13.4805 17 13.7348 17 14L17.0049 14.0986C17.0276 14.3276 17.1288 14.5429 17.293 14.707C17.4805 14.8946 17.7348 15 18 15L21 15V13L18 13ZM5 4C4.73478 4 4.48051 4.10543 4.29297 4.29297C4.10543 4.48051 4 4.73478 4 5L4.00488 5.09863C4.02757 5.32763 4.12883 5.54289 4.29297 5.70703C4.48051 5.89457 4.73478 6 5 6L18 6V4L5 4ZM20 6C20.5304 6 21.039 6.21086 21.4141 6.58594C21.7891 6.96101 22 7.46957 22 8L22 11.2695C22.1498 11.3561 22.2896 11.4615 22.4141 11.5859C22.7891 11.961 23 12.4696 23 13V15C23 15.5304 22.7891 16.039 22.4141 16.4141C22.039 16.7891 21.5304 17 21 17L18 17C17.2043 17 16.4415 16.6837 15.8789 16.1211C15.3867 15.6289 15.0829 14.9835 15.0146 14.2969L15 14C15 13.2043 15.3163 12.4415 15.8789 11.8789C16.4415 11.3163 17.2043 11 18 11H20L20 8L5 8C4.20435 8 3.44152 7.6837 2.87891 7.12109C2.38671 6.6289 2.08291 5.98351 2.01465 5.29688L2 5C2 4.20435 2.3163 3.44152 2.87891 2.87891C3.44152 2.3163 4.20435 2 5 2L18 2L18.1973 2.00977C18.6553 2.05515 19.0858 2.25765 19.4141 2.58594C19.7891 2.96101 20 3.46957 20 4V6Z" fill="#171A1F" />
                <path d="M2 19L2 5C2 4.44772 2.44772 4 3 4C3.55228 4 4 4.44772 4 5L4 19C4 19.2652 4.10543 19.5195 4.29297 19.707C4.48051 19.8946 4.73478 20 5 20L20 20V16C20 15.4477 20.4477 15 21 15C21.5523 15 22 15.4477 22 16V20C22 20.5304 21.7891 21.039 21.4141 21.4141C21.039 21.7891 20.5304 22 20 22L5 22C4.20435 22 3.44152 21.6837 2.87891 21.1211C2.3163 20.5585 2 19.7956 2 19Z" fill="#171A1F" />
              </svg>
            </div>
            <div className="method-info">
              <span className="method-name">OxPay Wallet Balance</span>
              <span className="method-detail">S$1,250 available</span>
            </div>
            {selectedMethod === 'wallet' && <div className="check-icon">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_1006)">
                  <path d="M8.58136 0.978143C10.5155 0.673438 12.4926 0.999374 14.2228 1.90136L14.5648 2.0894L14.6362 2.1348C14.9777 2.38063 15.0842 2.85023 14.8696 3.22255C14.6548 3.59484 14.1948 3.73789 13.811 3.56541L13.7357 3.52651L13.4552 3.37332C12.0398 2.63543 10.4223 2.36865 8.83998 2.61788C7.15219 2.88379 5.60628 3.72041 4.46056 4.98792C3.31487 6.25549 2.63817 7.87773 2.54362 9.58368C2.4491 11.2897 2.94233 12.9771 3.94101 14.3635C4.93967 15.7498 6.38378 16.7521 8.03184 17.2028C9.67986 17.6535 11.4329 17.5257 12.998 16.8405C14.5633 16.1554 15.8465 14.9538 16.6334 13.437C17.371 12.0152 17.6306 10.3964 17.379 8.82017L17.3215 8.50568L17.3094 8.42143C17.2676 8.00298 17.5483 7.61246 17.9692 7.52655C18.3904 7.44073 18.8021 7.6905 18.9272 8.09231L18.9483 8.17418L19.018 8.55838C19.3255 10.4851 19.0078 12.4635 18.1061 14.2014C17.1444 16.0551 15.5766 17.5237 13.6635 18.3611C11.7506 19.1985 9.6084 19.3544 7.59414 18.8037C5.5798 18.2528 3.81448 17.0282 2.59388 15.3338C1.3733 13.6392 0.770553 11.5773 0.886053 9.49213C1.00159 7.40697 1.82902 5.42433 3.22935 3.87504C4.62967 2.32585 6.51856 1.30315 8.58136 0.978143Z" fill="#171A1F" />
                  <path d="M17.7915 2.70625C18.1175 2.44036 18.5981 2.45911 18.9019 2.76299C19.2059 3.06687 19.2246 3.54744 18.9587 3.87344L18.9019 3.93666L10.6019 12.2366C10.2981 12.5405 9.81749 12.5593 9.49155 12.2934L9.4283 12.2366L6.93828 9.74664L6.88154 9.68347C6.61565 9.35745 6.6344 8.87688 6.93828 8.57302C7.24215 8.26911 7.72273 8.25036 8.04873 8.51624L8.11195 8.57302L10.0151 10.4761L17.7283 2.76299L17.7915 2.70625Z" fill="#171A1F" />
                </g>
                <defs>
                  <clipPath id="clip0_1_1006">
                    <rect width="20" height="20" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>}
          </button>

          <button
            className={`payment-method-card ${selectedMethod === 'card' ? 'selected' : ''}`}
            onClick={() => setSelectedMethod('card')}
          >
            <div className="method-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21 7C21 6.44772 20.5523 6 20 6L4 6C3.44772 6 3 6.44772 3 7L3 17C3 17.5523 3.44772 18 4 18L20 18C20.5523 18 21 17.5523 21 17L21 7ZM23 17C23 18.6569 21.6569 20 20 20L4 20C2.34315 20 1 18.6569 1 17L1 7C1 5.34315 2.34315 4 4 4L20 4C21.6569 4 23 5.34315 23 7L23 17Z" fill="#171A1F" />
                <path d="M22 9C22.5523 9 23 9.44772 23 10C23 10.5523 22.5523 11 22 11L2 11C1.44772 11 1 10.5523 1 10C1 9.44772 1.44772 9 2 9L22 9Z" fill="#171A1F" />
              </svg>
            </div>
            <div className="method-info">
              <span className="method-name">Credit/Debit Card</span>
              <span className="method-detail">Visa ••••5678</span>
            </div>
            {selectedMethod === 'card' && <div className="check-icon">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_1006)">
                  <path d="M8.58136 0.978143C10.5155 0.673438 12.4926 0.999374 14.2228 1.90136L14.5648 2.0894L14.6362 2.1348C14.9777 2.38063 15.0842 2.85023 14.8696 3.22255C14.6548 3.59484 14.1948 3.73789 13.811 3.56541L13.7357 3.52651L13.4552 3.37332C12.0398 2.63543 10.4223 2.36865 8.83998 2.61788C7.15219 2.88379 5.60628 3.72041 4.46056 4.98792C3.31487 6.25549 2.63817 7.87773 2.54362 9.58368C2.4491 11.2897 2.94233 12.9771 3.94101 14.3635C4.93967 15.7498 6.38378 16.7521 8.03184 17.2028C9.67986 17.6535 11.4329 17.5257 12.998 16.8405C14.5633 16.1554 15.8465 14.9538 16.6334 13.437C17.371 12.0152 17.6306 10.3964 17.379 8.82017L17.3215 8.50568L17.3094 8.42143C17.2676 8.00298 17.5483 7.61246 17.9692 7.52655C18.3904 7.44073 18.8021 7.6905 18.9272 8.09231L18.9483 8.17418L19.018 8.55838C19.3255 10.4851 19.0078 12.4635 18.1061 14.2014C17.1444 16.0551 15.5766 17.5237 13.6635 18.3611C11.7506 19.1985 9.6084 19.3544 7.59414 18.8037C5.5798 18.2528 3.81448 17.0282 2.59388 15.3338C1.3733 13.6392 0.770553 11.5773 0.886053 9.49213C1.00159 7.40697 1.82902 5.42433 3.22935 3.87504C4.62967 2.32585 6.51856 1.30315 8.58136 0.978143Z" fill="#171A1F" />
                  <path d="M17.7915 2.70625C18.1175 2.44036 18.5981 2.45911 18.9019 2.76299C19.2059 3.06687 19.2246 3.54744 18.9587 3.87344L18.9019 3.93666L10.6019 12.2366C10.2981 12.5405 9.81749 12.5593 9.49155 12.2934L9.4283 12.2366L6.93828 9.74664L6.88154 9.68347C6.61565 9.35745 6.6344 8.87688 6.93828 8.57302C7.24215 8.26911 7.72273 8.25036 8.04873 8.51624L8.11195 8.57302L10.0151 10.4761L17.7283 2.76299L17.7915 2.70625Z" fill="#171A1F" />
                </g>
                <defs>
                  <clipPath id="clip0_1_1006">
                    <rect width="20" height="20" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>}
          </button>

          <button
            className={`payment-method-card ${selectedMethod === 'qr' ? 'selected' : ''}`}
            onClick={() => setSelectedMethod('qr')}
          >
            <div className="method-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21 8C21 7.44772 20.5523 7 20 7L4 7C3.44772 7 3 7.44772 3 8L3 16C3 16.5523 3.44772 17 4 17L20 17C20.5523 17 21 16.5523 21 16L21 8ZM23 16C23 17.6569 21.6569 19 20 19L4 19C2.34315 19 1 17.6569 1 16L1 8C1 6.34315 2.34315 5 4 5L20 5C21.6569 5 23 6.34315 23 8L23 16Z" fill="#171A1F" />
                <path d="M13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12ZM15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z" fill="#171A1F" />
                <path d="M6.00977 11L6.1123 11.0049C6.61655 11.0561 7.00977 11.4822 7.00977 12C7.00977 12.5178 6.61655 12.9439 6.1123 12.9951L6.00977 13H6C5.44772 13 5 12.5523 5 12C5 11.4477 5.44772 11 6 11H6.00977ZM18.0098 11L18.1123 11.0049C18.6165 11.0561 19.0098 11.4822 19.0098 12C19.0098 12.5178 18.6165 12.9439 18.1123 12.9951L18.0098 13H18C17.4477 13 17 12.5523 17 12C17 11.4477 17.4477 11 18 11H18.0098Z" fill="#171A1F" />
              </svg>
            </div>
            <div className="method-info">
              <span className="method-name">QR Payments</span>
              <span className="method-detail">Payment Page</span>
            </div>
            {selectedMethod === 'qr' && <div className="check-icon">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_1_1006)">
                  <path d="M8.58136 0.978143C10.5155 0.673438 12.4926 0.999374 14.2228 1.90136L14.5648 2.0894L14.6362 2.1348C14.9777 2.38063 15.0842 2.85023 14.8696 3.22255C14.6548 3.59484 14.1948 3.73789 13.811 3.56541L13.7357 3.52651L13.4552 3.37332C12.0398 2.63543 10.4223 2.36865 8.83998 2.61788C7.15219 2.88379 5.60628 3.72041 4.46056 4.98792C3.31487 6.25549 2.63817 7.87773 2.54362 9.58368C2.4491 11.2897 2.94233 12.9771 3.94101 14.3635C4.93967 15.7498 6.38378 16.7521 8.03184 17.2028C9.67986 17.6535 11.4329 17.5257 12.998 16.8405C14.5633 16.1554 15.8465 14.9538 16.6334 13.437C17.371 12.0152 17.6306 10.3964 17.379 8.82017L17.3215 8.50568L17.3094 8.42143C17.2676 8.00298 17.5483 7.61246 17.9692 7.52655C18.3904 7.44073 18.8021 7.6905 18.9272 8.09231L18.9483 8.17418L19.018 8.55838C19.3255 10.4851 19.0078 12.4635 18.1061 14.2014C17.1444 16.0551 15.5766 17.5237 13.6635 18.3611C11.7506 19.1985 9.6084 19.3544 7.59414 18.8037C5.5798 18.2528 3.81448 17.0282 2.59388 15.3338C1.3733 13.6392 0.770553 11.5773 0.886053 9.49213C1.00159 7.40697 1.82902 5.42433 3.22935 3.87504C4.62967 2.32585 6.51856 1.30315 8.58136 0.978143Z" fill="#171A1F" />
                  <path d="M17.7915 2.70625C18.1175 2.44036 18.5981 2.45911 18.9019 2.76299C19.2059 3.06687 19.2246 3.54744 18.9587 3.87344L18.9019 3.93666L10.6019 12.2366C10.2981 12.5405 9.81749 12.5593 9.49155 12.2934L9.4283 12.2366L6.93828 9.74664L6.88154 9.68347C6.61565 9.35745 6.6344 8.87688 6.93828 8.57302C7.24215 8.26911 7.72273 8.25036 8.04873 8.51624L8.11195 8.57302L10.0151 10.4761L17.7283 2.76299L17.7915 2.70625Z" fill="#171A1F" />
                </g>
                <defs>
                  <clipPath id="clip0_1_1006">
                    <rect width="20" height="20" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>}
          </button>
        </div>

        {/* Amount Summary */}
        <div className="amount-summary-card">
          <div className="summary-row">
            <span className="summary-label">Amount:</span>
            <span className="summary-value">S${amount}</span>
          </div>
          <div className="summary-row">
            <span className="summary-label">Fee:</span>
            <span className="summary-value">S${fee.toFixed(2)}</span>
          </div>
          <div className="summary-divider"></div>
          <div className="summary-row total-row">
            <span className="summary-label-total">Total:</span>
            <span className="summary-value-total">S${total.toFixed(2)}</span>
          </div>
        </div>

        {/* Continue Button */}
        <button className="continue-to-review-btn" onClick={handleContinue}>
          Continue to Review
        </button>
      </div>
    </div>
  );
};

export default SelectPaymentMethodScreen;
